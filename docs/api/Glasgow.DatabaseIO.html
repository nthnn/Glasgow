<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>Class DatabaseIO | Glasgow </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="Class DatabaseIO | Glasgow ">
      
      <meta name="description" content="Handles secure serialization and deserialization of a  instance to and from disk. This class provides AES-256-CBC encryption for secure database persistence, using a passphrase-derived key via PBKDF2 and a randomly generated Initialization Vector (IV) embedded at the start of the file. All data (including table structure and row content) is stored in a binary format after encryption.  Security Considerations: Encryption uses AES-256-CBC for strong symmetric encryption.Keys are derived from passphrases using PBKDF2 to resist brute force attacks.The IV is stored unencrypted at the beginning of the file and is used for key derivation and decryption.   Typical Usage: - Use  to persist a  securely. - Use  to recover it using the same passphrase.">
      <link rel="icon" href="../favicon.ico">
      <link rel="stylesheet" href="../public/docfx.min.css">
      <link rel="stylesheet" href="../public/main.css">
      <meta name="docfx:navrel" content="../toc.html">
      <meta name="docfx:tocrel" content="toc.html">
      
      <meta name="docfx:rel" content="../">
      
      
      <meta name="docfx:docurl" content="https://github.com/nthnn/Glasgow/new/main/apiSpec/new?filename=Glasgow_DatabaseIO.md&amp;value=---%0Auid%3A%20Glasgow.DatabaseIO%0Asummary%3A%20&#39;*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax&#39;%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">

      <script type="module" src="./../public/docfx.min.js"></script>

      <script>
        const theme = localStorage.getItem('theme') || 'auto'
        document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
      </script>

  </head>

  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="ManagedReference">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../index.html">
            <img id="logo" class="svg" src="../logo.svg" alt="Glasgow">
            Glasgow
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="Glasgow.DatabaseIO">



  <h1 id="Glasgow_DatabaseIO" data-uid="Glasgow.DatabaseIO" class="text-break">
Class DatabaseIO  <a class="header-action link-secondary" title="View source" href="https://github.com/nthnn/Glasgow/blob/main/Glasgow/Glasgow.DatabaseIO.cs/#L35"><i class="bi bi-code-slash"></i></a>
  </h1>

  <div class="facts text-secondary">
    <dl><dt>Namespace</dt><dd><a class="xref" href="Glasgow.html">Glasgow</a></dd></dl>
  <dl><dt>Assembly</dt><dd>Glasgow.dll</dd></dl>
  </div>

  <div class="markdown summary"><p>Handles secure serialization and deserialization of a <a class="xref" href="Glasgow.GlasgowDB.html">GlasgowDB</a> instance to and from disk.</p>
<p>This class provides AES-256-CBC encryption for secure database persistence, using a passphrase-derived key
via PBKDF2 and a randomly generated Initialization Vector (IV) embedded at the start of the file.</p>
<p>All data (including table structure and row content) is stored in a binary format after encryption.</p>
<p>
<b>Security Considerations:</b>
<ul><li>Encryption uses AES-256-CBC for strong symmetric encryption.</li><li>Keys are derived from passphrases using PBKDF2 to resist brute force attacks.</li><li>The IV is stored unencrypted at the beginning of the file and is used for key derivation and decryption.</li></ul>

<p>
<b>Typical Usage:</b><br>
- Use <a class="xref" href="Glasgow.DatabaseIO.html#Glasgow_DatabaseIO_SaveToFile_Glasgow_GlasgowDB_System_String_System_String_">SaveToFile(GlasgowDB, string, string)</a> to persist a <a class="xref" href="Glasgow.GlasgowDB.html">GlasgowDB</a> securely.<br>
- Use <a class="xref" href="Glasgow.DatabaseIO.html#Glasgow_DatabaseIO_LoadFromFile_System_String_System_String_">LoadFromFile(string, string)</a> to recover it using the same passphrase.
</p>
</div>
  <div class="markdown conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public class DatabaseIO</code></pre>
  </div>




  <dl class="typelist inheritance">
    <dt>Inheritance</dt>
    <dd>
      <div><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object">object</a></div>
      <div><span class="xref">DatabaseIO</span></div>
    </dd>
  </dl>



  <dl class="typelist inheritedMembers">
    <dt>Inherited Members</dt>
    <dd>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.equals#system-object-equals(system-object)">object.Equals(object)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.equals#system-object-equals(system-object-system-object)">object.Equals(object, object)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.gethashcode">object.GetHashCode()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.gettype">object.GetType()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.memberwiseclone">object.MemberwiseClone()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.referenceequals">object.ReferenceEquals(object, object)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.tostring">object.ToString()</a>
    </div>
  </dd></dl>






  <h2 class="section" id="methods">Methods
</h2>


  <a id="Glasgow_DatabaseIO_LoadFromFile_" data-uid="Glasgow.DatabaseIO.LoadFromFile*"></a>

  <h3 id="Glasgow_DatabaseIO_LoadFromFile_System_String_System_String_" data-uid="Glasgow.DatabaseIO.LoadFromFile(System.String,System.String)">
  LoadFromFile(string, string)
  <a class="header-action link-secondary" title="View source" href="https://github.com/nthnn/Glasgow/blob/main/Glasgow/Glasgow.DatabaseIO.cs/#L60"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Loads and decrypts a <a class="xref" href="Glasgow.GlasgowDB.html">GlasgowDB</a> instance from the specified encrypted file.</p>
<p>If the file does not exist, an empty instance is returned (i.e., a new <a class="xref" href="Glasgow.GlasgowDB.html">GlasgowDB</a> with no tables).</p>
<p>
Decryption uses the AES-256-CBC algorithm with a passphrase-derived key using PBKDF2. 
The IV required for decryption is read from the beginning of the file.
</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static GlasgowDB LoadFromFile(string FileName, string PassKey)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>FileName</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.string">string</a></dt>
    <dd><p>Path to the encrypted file containing the serialized database.</p>
</dd>
    <dt><code>PassKey</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.string">string</a></dt>
    <dd><p>Passphrase to derive the decryption key. Must match the passphrase used to save the file.</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="Glasgow.GlasgowDB.html">GlasgowDB</a></dt>
    <dd><p>A populated <a class="xref" href="Glasgow.GlasgowDB.html">GlasgowDB</a> instance if decryption and deserialization succeed,
or an empty instance if the file is missing.</p>
</dd>
  </dl>








  <h4 class="section">Exceptions</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.io.endofstreamexception">EndOfStreamException</a></dt>
    <dd><p>Thrown if the file is too short to contain a valid IV or unexpectedly ends during reading.</p>
</dd>
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.invalidoperationexception">InvalidOperationException</a></dt>
    <dd><p>Thrown when the passphrase is incorrect or the file is corrupted, leading to decryption failure
or unexpected binary format during deserialization.</p>
</dd>
  </dl>



  <a id="Glasgow_DatabaseIO_SaveToFile_" data-uid="Glasgow.DatabaseIO.SaveToFile*"></a>

  <h3 id="Glasgow_DatabaseIO_SaveToFile_Glasgow_GlasgowDB_System_String_System_String_" data-uid="Glasgow.DatabaseIO.SaveToFile(Glasgow.GlasgowDB,System.String,System.String)">
  SaveToFile(GlasgowDB, string, string)
  <a class="header-action link-secondary" title="View source" href="https://github.com/nthnn/Glasgow/blob/main/Glasgow/Glasgow.DatabaseIO.cs/#L158"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Saves the given <a class="xref" href="Glasgow.GlasgowDB.html">GlasgowDB</a> instance to an encrypted file at the specified path,
using AES-256 in CBC mode. The file will begin with a randomly generated IV.</p>
<p>A random Initialization Vector (IV) is generated for each write and stored at the beginning of the file.
The encryption key is derived from the provided passphrase and this IV using PBKDF2.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static void SaveToFile(GlasgowDB Database, string FileName, string PassKey)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>Database</code> <a class="xref" href="Glasgow.GlasgowDB.html">GlasgowDB</a></dt>
    <dd><p>The <a class="xref" href="Glasgow.GlasgowDB.html">GlasgowDB</a> to serialize and encrypt.</p>
</dd>
    <dt><code>FileName</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.string">string</a></dt>
    <dd><p>The destination file path. If the file already exists, it will be overwritten.</p>
</dd>
    <dt><code>PassKey</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.string">string</a></dt>
    <dd><p>The passphrase used to derive the AES encryption key. Must be provided again to decrypt via <a class="xref" href="Glasgow.DatabaseIO.html#Glasgow_DatabaseIO_LoadFromFile_System_String_System_String_">LoadFromFile(string, string)</a>.</p>
</dd>
  </dl>













</article>

        <div class="contribution d-print-none">
          <a href="https://github.com/nthnn/Glasgow/blob/main/Glasgow/Glasgow.DatabaseIO.cs/#L35" class="edit-link">Edit this page</a>
        </div>


      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          <span>Made with <a href="https://dotnet.github.io/docfx">docfx</a></span>
        </div>
      </div>
    </footer>
  </body>
</html>
