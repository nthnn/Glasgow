<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>Class UpdateCommand | Glasgow </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="Class UpdateCommand | Glasgow ">
      
      <meta name="description" content="Constructs and runs an UPDATE operation against a specified table in a  instance.  This class leverages the filtering functionality inherited from  to enable WHERE clauses that refine which rows to update. Each  call adds an additional predicate: all predicates are combined with logical AND semantics.   Example usage: int rowsAffected = db.Update(&quot;Users&quot;)                       .Set(&quot;IsActive&quot;, false)                       .Where(Operator.LESS_THAN, &quot;LastLogin&quot;, someDate)                       .Execute(); This example sets the IsActive column to false for all rows in the &quot;Users&quot; table whose LastLogin is earlier than someDate.   If the specified table does not exist in the database,  returns zero without throwing.">
      <link rel="icon" href="../favicon.ico">
      <link rel="stylesheet" href="../public/docfx.min.css">
      <link rel="stylesheet" href="../public/main.css">
      <meta name="docfx:navrel" content="../toc.html">
      <meta name="docfx:tocrel" content="toc.html">
      
      <meta name="docfx:rel" content="../">
      
      
      <meta name="docfx:docurl" content="https://github.com/nthnn/Glasgow/new/main/apiSpec/new?filename=Glasgow_UpdateCommand.md&amp;value=---%0Auid%3A%20Glasgow.UpdateCommand%0Asummary%3A%20&#39;*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax&#39;%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">

      <script type="module" src="./../public/docfx.min.js"></script>

      <script>
        const theme = localStorage.getItem('theme') || 'auto'
        document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
      </script>

  </head>

  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="ManagedReference">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../index.html">
            <img id="logo" class="svg" src="../logo.svg" alt="Glasgow">
            Glasgow
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="Glasgow.UpdateCommand">



  <h1 id="Glasgow_UpdateCommand" data-uid="Glasgow.UpdateCommand" class="text-break">
Class UpdateCommand  <a class="header-action link-secondary" title="View source" href="https://github.com/nthnn/Glasgow/blob/main/Glasgow/Glasgow.Command.UpdateCommand.cs/#L39"><i class="bi bi-code-slash"></i></a>
  </h1>

  <div class="facts text-secondary">
    <dl><dt>Namespace</dt><dd><a class="xref" href="Glasgow.html">Glasgow</a></dd></dl>
  <dl><dt>Assembly</dt><dd>Glasgow.dll</dd></dl>
  </div>

  <div class="markdown summary"><p>Constructs and runs an UPDATE operation against a specified table in a <a class="xref" href="Glasgow.GlasgowDB.html">GlasgowDB</a> instance.</p>
<p>
This class leverages the filtering functionality inherited from <a class="xref" href="Glasgow.QueryBase.html">QueryBase</a> to enable
<code>WHERE</code> clauses that refine which rows to update. Each <a class="xref" href="Glasgow.UpdateCommand.html#Glasgow_UpdateCommand_Where_Glasgow_Operator_System_String_System_Object_">Where(Operator, string, object)</a> call adds an additional
predicate: all predicates are combined with logical AND semantics.
</p>
<p>
Example usage:
<pre><code class="lang-csharp">int rowsAffected = db.Update("Users")
                      .Set("IsActive", false)
                      .Where(Operator.LESS_THAN, "LastLogin", someDate)
                      .Execute();</code></pre>
This example sets the <code>IsActive</code> column to <code>false</code> for all rows in the "Users" table
whose <code>LastLogin</code> is earlier than <code>someDate</code>.

<p>
If the specified table does not exist in the database, <a class="xref" href="Glasgow.UpdateCommand.html#Glasgow_UpdateCommand_Execute">Execute()</a> returns zero without throwing.
</p>
</div>
  <div class="markdown conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public class UpdateCommand : QueryBase</code></pre>
  </div>




  <dl class="typelist inheritance">
    <dt>Inheritance</dt>
    <dd>
      <div><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object">object</a></div>
      <div><a class="xref" href="Glasgow.QueryBase.html">QueryBase</a></div>
      <div><span class="xref">UpdateCommand</span></div>
    </dd>
  </dl>



  <dl class="typelist inheritedMembers">
    <dt>Inherited Members</dt>
    <dd>
    <div>
      <a class="xref" href="Glasgow.QueryBase.html#Glasgow_QueryBase__filters">QueryBase._filters</a>
    </div>
    <div>
      <a class="xref" href="Glasgow.QueryBase.html#Glasgow_QueryBase_IsNumericType_System_Type_">QueryBase.IsNumericType(Type)</a>
    </div>
    <div>
      <a class="xref" href="Glasgow.QueryBase.html#Glasgow_QueryBase_WildcardMatch_System_String_System_String_">QueryBase.WildcardMatch(string, string)</a>
    </div>
    <div>
      <a class="xref" href="Glasgow.QueryBase.html#Glasgow_QueryBase_Where__1_Glasgow_Operator_System_String_System_Object_">QueryBase.Where&lt;T&gt;(Operator, string, object)</a>
    </div>
    <div>
      <a class="xref" href="Glasgow.QueryBase.html#Glasgow_QueryBase_ApplyFilters_System_Collections_Generic_IEnumerable_System_Collections_Generic_Dictionary_System_String_System_Object___">QueryBase.ApplyFilters(IEnumerable&lt;Dictionary&lt;string, object&gt;&gt;)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.equals#system-object-equals(system-object)">object.Equals(object)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.equals#system-object-equals(system-object-system-object)">object.Equals(object, object)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.gethashcode">object.GetHashCode()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.gettype">object.GetType()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.memberwiseclone">object.MemberwiseClone()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.referenceequals">object.ReferenceEquals(object, object)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.tostring">object.ToString()</a>
    </div>
  </dd></dl>






  <h2 class="section" id="constructors">Constructors
</h2>


  <a id="Glasgow_UpdateCommand__ctor_" data-uid="Glasgow.UpdateCommand.#ctor*"></a>

  <h3 id="Glasgow_UpdateCommand__ctor_Glasgow_GlasgowDB_System_String_" data-uid="Glasgow.UpdateCommand.#ctor(Glasgow.GlasgowDB,System.String)">
  UpdateCommand(GlasgowDB, string)
  <a class="header-action link-secondary" title="View source" href="https://github.com/nthnn/Glasgow/blob/main/Glasgow/Glasgow.Command.UpdateCommand.cs/#L39"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Constructs and runs an UPDATE operation against a specified table in a <a class="xref" href="Glasgow.GlasgowDB.html">GlasgowDB</a> instance.</p>
<p>
This class leverages the filtering functionality inherited from <a class="xref" href="Glasgow.QueryBase.html">QueryBase</a> to enable
<code>WHERE</code> clauses that refine which rows to update. Each <a class="xref" href="Glasgow.UpdateCommand.html#Glasgow_UpdateCommand_Where_Glasgow_Operator_System_String_System_Object_">Where(Operator, string, object)</a> call adds an additional
predicate: all predicates are combined with logical AND semantics.
</p>
<p>
Example usage:
<pre><code class="lang-csharp">int rowsAffected = db.Update("Users")
                      .Set("IsActive", false)
                      .Where(Operator.LESS_THAN, "LastLogin", someDate)
                      .Execute();</code></pre>
This example sets the <code>IsActive</code> column to <code>false</code> for all rows in the "Users" table
whose <code>LastLogin</code> is earlier than <code>someDate</code>.

<p>
If the specified table does not exist in the database, <a class="xref" href="Glasgow.UpdateCommand.html#Glasgow_UpdateCommand_Execute">Execute()</a> returns zero without throwing.
</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public UpdateCommand(GlasgowDB Instance, string Table)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>Instance</code> <a class="xref" href="Glasgow.GlasgowDB.html">GlasgowDB</a></dt>
    <dd><p>The <a class="xref" href="Glasgow.GlasgowDB.html">GlasgowDB</a> instance against which this update operation will be performed.
All modifications occur directly in this instance's in-memory table store.</p>
</dd>
    <dt><code>Table</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.string">string</a></dt>
    <dd><p>The name of the table whose rows will be updated. Must be a non-null, non-empty string;
if the table does not exist, no action is taken.</p>
</dd>
  </dl>












  <h2 class="section" id="methods">Methods
</h2>


  <a id="Glasgow_UpdateCommand_Execute_" data-uid="Glasgow.UpdateCommand.Execute*"></a>

  <h3 id="Glasgow_UpdateCommand_Execute" data-uid="Glasgow.UpdateCommand.Execute">
  Execute()
  <a class="header-action link-secondary" title="View source" href="https://github.com/nthnn/Glasgow/blob/main/Glasgow/Glasgow.Command.UpdateCommand.cs/#L188"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Executes the UPDATE operation against the underlying table, modifying all rows that satisfy
the accumulated filter predicates. If the table does not exist, no rows are updated and zero is returned.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public int Execute()</code></pre>
  </div>


  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.int32">int</a></dt>
    <dd><p>The number of rows successfully updated in the table.</p>
</dd>
  </dl>







  <h4 class="section" id="Glasgow_UpdateCommand_Execute_remarks">Remarks</h4>
  <div class="markdown level1 remarks"><p>
<strong>Algorithm:</strong>
<ol><li>
    Verify that the target table exists in <code>DbInstance.Database</code>. If not, return 0 immediately.
  </li><li>
    Iterate through each <code>row</code> in <code>table.Rows</code>. For each row, evaluate all predicates
    in <code>_filters</code> (inherited from <a class="xref" href="Glasgow.QueryBase.html">QueryBase</a>). Only if every predicate returns <code>true</code>
    is the row considered for updating.
  </li><li>
    For each matching row, iterate through all key/value pairs in <code>Updates</code>. 
    Assign the new value to <code>row[update.Key]</code>. If the column does not exist in the table schema,
    add <code>update.Key</code> to <code>table.ColumnNames</code> so that future operations recognize it.
  </li><li>
    Increment <code>updatedCount</code> for each row modified.
  </li><li>
    Return <code>updatedCount</code> once all rows have been processed.
  </li></ol>

<p>
<strong>Notes on Type Handling:</strong>
<ul><li>
    Numeric comparators (<code>&lt;</code>, <code>&gt;</code>, etc.) only apply if both the existing row value
    and <code class="paramref">Value</code> are numeric types (int, long, double, float, decimal, short, or byte).
  </li><li>
    String comparisons (e.g., <code>Operator.CONTAINS</code>, <code>Operator.STARTS_WITH</code>, <code>Operator.ENDS_WITH</code>)
    perform case-insensitive matches. Wildcards (using '*') are also supported when <code>Operator.EQUALS</code>
    or <code>Operator.NOT_EQUALS</code> is used with a pattern containing '*'.
  </li><li>
    DateTime comparisons use <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.datetime">DateTime</a> comparison operators directly.
  </li><li>
    Boolean comparisons only support <code>Operator.EQUALS</code> and <code>Operator.NOT_EQUALS</code>.
  </li><li>
    Byte-array comparisons (<code>byte[]</code>) only support <code>Operator.EQUALS</code> and
    <code>Operator.NOT_EQUALS</code>, using sequence equality.
  </li></ul>

<p>
<strong>Thread Safety:</strong> 
<code>GlasgowDB</code> is not inherently thread-safe. If multiple threads perform <code>UpdateCommand</code> on
the same table concurrently without external synchronization, the result may be unpredictable
due to race conditions on <code>List&lt;Dictionary&lt;string, object&gt;&gt;.Remove</code> and
direct assignment to <code>row[column]</code>.
</p>
<p>
<strong>Side Effects:</strong>
Once <a class="xref" href="Glasgow.UpdateCommand.html#Glasgow_UpdateCommand_Execute">Execute()</a> is called, the in-memory table is modified immediately. There is no built-in
rollback or versioning; if an update should be undone, the caller must manually revert changes or use a backup/copy.
</p>
</div>

  <h4 class="section">Exceptions</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.invalidoperationexception">InvalidOperationException</a></dt>
    <dd><p>
This method does not throw if the table is missing. However, if the internal state of the table or filters
is corrupted (e.g., <code>Table.Rows</code> is null), unexpected exceptions (such as <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.nullreferenceexception">NullReferenceException</a>) may propagate.
</p>
</dd>
  </dl>



  <a id="Glasgow_UpdateCommand_Set_" data-uid="Glasgow.UpdateCommand.Set*"></a>

  <h3 id="Glasgow_UpdateCommand_Set_System_String_System_Object_" data-uid="Glasgow.UpdateCommand.Set(System.String,System.Object)">
  Set(string, object)
  <a class="header-action link-secondary" title="View source" href="https://github.com/nthnn/Glasgow/blob/main/Glasgow/Glasgow.Command.UpdateCommand.cs/#L77"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Specifies a column and its new value to be applied to rows matching the <code>WHERE</code> filters.
Multiple <a class="xref" href="Glasgow.UpdateCommand.html#Glasgow_UpdateCommand_Set_System_String_System_Object_">Set(string, object)</a> calls can be chained to update multiple columns at once.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public UpdateCommand Set(string ColumnName, object Value)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>ColumnName</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.string">string</a></dt>
    <dd><p>The name of the column to update. If this column does not already exist in a particular row,
it will be added to that row and to <a class="xref" href="Glasgow.Table.html#Glasgow_Table_ColumnNames">ColumnNames</a>. Column names are case-sensitive.</p>
</dd>
    <dt><code>Value</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object">object</a></dt>
    <dd><p>The new value to assign to <code class="paramref">ColumnName</code>. Its runtime type should match
the data type expected for that column (e.g., <code>int</code>, <code>string</code>, <code>DateTime</code>, etc.).</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="Glasgow.UpdateCommand.html">UpdateCommand</a></dt>
    <dd><p>The same <a class="xref" href="Glasgow.UpdateCommand.html">UpdateCommand</a> instance, allowing additional <a class="xref" href="Glasgow.UpdateCommand.html#Glasgow_UpdateCommand_Set_System_String_System_Object_">Set(string, object)</a> or <a class="xref" href="Glasgow.UpdateCommand.html#Glasgow_UpdateCommand_Where_Glasgow_Operator_System_String_System_Object_">Where(Operator, string, object)</a>
calls to be chained before executing.</p>
</dd>
  </dl>







  <h4 class="section" id="Glasgow_UpdateCommand_Set_System_String_System_Object__remarks">Remarks</h4>
  <div class="markdown level1 remarks"><p>Each call to <a class="xref" href="Glasgow.UpdateCommand.html#Glasgow_UpdateCommand_Set_System_String_System_Object_">Set(string, object)</a> replaces or adds a key/value pair in the internal <code>Updates</code> dictionary.
If the same column is <a class="xref" href="Glasgow.UpdateCommand.html#Glasgow_UpdateCommand_Set_System_String_System_Object_">Set(string, object)</a> more than once, the last value provided will be used.</p>
</div>




  <a id="Glasgow_UpdateCommand_Where_" data-uid="Glasgow.UpdateCommand.Where*"></a>

  <h3 id="Glasgow_UpdateCommand_Where_Glasgow_Operator_System_String_System_Object_" data-uid="Glasgow.UpdateCommand.Where(Glasgow.Operator,System.String,System.Object)">
  Where(Operator, string, object)
  <a class="header-action link-secondary" title="View source" href="https://github.com/nthnn/Glasgow/blob/main/Glasgow/Glasgow.Command.UpdateCommand.cs/#L104"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Adds a filtering condition (<code>WHERE</code> clause) to this update command, matching only rows where
the specified column satisfies the comparison operator against the provided value.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public UpdateCommand Where(Operator Operation, string ColumnName, object Value)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>Operation</code> <a class="xref" href="Glasgow.Operator.html">Operator</a></dt>
    <dd><p>The comparison operator to apply (e.g., <a class="xref" href="Glasgow.Operator.html#Glasgow_Operator_EQUALS">EQUALS</a>, <a class="xref" href="Glasgow.Operator.html#Glasgow_Operator_NOT_EQUALS">NOT_EQUALS</a>,
<a class="xref" href="Glasgow.Operator.html#Glasgow_Operator_LESS_THAN">LESS_THAN</a>, etc.). See <a class="xref" href="Glasgow.Operator.html">Operator</a> for all supported types.</p>
</dd>
    <dt><code>ColumnName</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.string">string</a></dt>
    <dd><p>The name of the column to compare. If a row lacks this column, that row is excluded.</p>
</dd>
    <dt><code>Value</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object">object</a></dt>
    <dd><p>The value to compare against. Must be of a compatible type for the column
(e.g., numeric comparisons for numeric columns, string comparisons for text columns, etc.).</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="Glasgow.UpdateCommand.html">UpdateCommand</a></dt>
    <dd><p>The same <a class="xref" href="Glasgow.UpdateCommand.html">UpdateCommand</a> instance, allowing further chaining of <a class="xref" href="Glasgow.UpdateCommand.html#Glasgow_UpdateCommand_Where_Glasgow_Operator_System_String_System_Object_">Where(Operator, string, object)</a> clauses.</p>
</dd>
  </dl>







  <h4 class="section" id="Glasgow_UpdateCommand_Where_Glasgow_Operator_System_String_System_Object__remarks">Remarks</h4>
  <div class="markdown level1 remarks"><p>Internally, this method calls the generic <a class="xref" href="Glasgow.QueryBase.html#Glasgow_QueryBase_Where__1_Glasgow_Operator_System_String_System_Object_">Where&lt;T&gt;(Operator, string, object)</a> implementation, which appends
a predicate delegate into the inherited <code>_filters</code> list. When <a class="xref" href="Glasgow.UpdateCommand.html#Glasgow_UpdateCommand_Execute">Execute()</a> is called,
only rows satisfying all accumulated predicates are updated.</p>
</div>





</article>

        <div class="contribution d-print-none">
          <a href="https://github.com/nthnn/Glasgow/blob/main/Glasgow/Glasgow.Command.UpdateCommand.cs/#L39" class="edit-link">Edit this page</a>
        </div>


      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          <span>Made with <a href="https://dotnet.github.io/docfx">docfx</a></span>
        </div>
      </div>
    </footer>
  </body>
</html>
